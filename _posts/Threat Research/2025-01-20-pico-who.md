---
title: "Example Blog"
classes: wide
header:
  teaser: /assets/images/china/raw.png
ribbon: black
description: "Infiltrating a suspected Chinese intellingence operation"
categories:
  - CTF Writeup
tags:
  - Threat Research
  - Malware Analysis
  - China
toc: true
---

# Open Directories

During malware execution chains or hands-on-keyboard intrusions, adversaries will often download additional malware or tooling on the fly, frequently using the HTTP protocol. Adversaries may achieve this by setting a simple Python HTTP server, `python -m http.server 80`, and then accessing the files via a regular HTTP request. 

Occasionally, when threat actors are hosting payloads over HTTP, they accidentally expose the whole entire directory and subdirectory of files, rather than the singular payload they intended to share. This can introduce a massive operational security failure for adversaries, as additional tooling, victim data, adversary credentials, and more, can be exposed. 

# Case Study

In some cases, like the one we will discuss, the OPSEC failure can be so significant that an entire potential espionage operation can be exposed, within a day. 

The research, found by [@xorJosh](https://x.com/xorJosh) and [@polygonben](https://x.com/polygonben), identified a Chinese threat actor that had successfully compromised at least 30 unique Vietnamese universities or educational facilities, many of which specialise in tech and engineering. This was identified via a singular open-directory that exposed massive amounts of sensitive threat actor data. This data did not suggest the threat actor was financially motivated, but rather they intended to persist in victim environments for long periods of time, gathering information. 

Evidence suggests the threat actor gained access to these organisations via exploitation of public facing vulnerabilities using *Metasploit*, uploading *Godzilla webshells*, or via *SQL injection*. Upon gaining a foothold, the adversary has been observed deploying Cobalt Strike beacons. Once the beacon is established, the actor has exploited local Windows vulnerabilities for privilege escalation and installed tunneling software for persistent remote access. 

Based on our observations and victimology, these tactics, techniques, and procedures (TTPs) show significant overlap with previously reported activity attributed to threat actor *Earth Lamia*, named by Trend Micro.

## .bash_history

When hunting for interesting open-directories, I always keep an eye out for the Linux `.bash_history` file. This can expose the commands run by an adversary on a Linux machine. It will reside in the user's home folder (e.g. `/home/ben/.bash_history`).

When we opened the `.bash_history` file on this host, we knew we were in for fun:
