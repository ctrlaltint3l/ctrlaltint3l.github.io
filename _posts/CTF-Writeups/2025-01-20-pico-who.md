---
title: "PicoCTF: Who are you? {Medium} {Web exploitation}}"
classes: wide
header:
  teaser: /assets/images/ctf-writeups/utctf2020/logo.png
ribbon: ForestGreen
description: "Writeup for the picoCTF "Who are you?" challenge in the web exploit category."
categories:
  - CTF Writeup
tags:
  - CTF
  - Writeup
  - Web Exploitation
---

# Overview 

Below is a writeup for the picoCTF "Who are you?" challenge in the web exploit category.

# Solution

- 1Ô∏è‚É£ Upon loading the initial site the page displays the message that only official ‚ÄòPicoBrowser‚Äô users are allowed to visit the site. This led to me realising that Burp Suite was likely needed to modify the initial HTTP request to the site.

![Pico screenshot](/assets/images/who-1.webp)

- Within Burp I modified the user agent to mimic the connection coming from the pico browser.

![Pico screenshot](/assets/images/who-2.webp)

- 2Ô∏è‚É£ After modifying the UA and forwarding the request I was then presented with a new message on the site.

![Pico screenshot](/assets/images/who-3.webp)

- This was a reference to the ‚Äúreferer‚Äù policy so by simply setting this to the origin domain it should accept this connection.

![Pico screenshot](/assets/images/who-4.webp)

- 3Ô∏è‚É£ After sending the previous request this then presented a new output.

![Pico screenshot](/assets/images/who-5.webp)

- To bypass this I set the ‚ÄúDate‚Äù header to a date from 2018 along with the other http header arguments from the previous steps.

![Pico screenshot](/assets/images/who-6.webp)

- 4Ô∏è‚É£ Once again a new output message was present indicating the previous attempts were successful but there was still more steps to go.

![Pico screenshot](/assets/images/who-7.webp)

- Initially, this message stumped me as I was unsure what header related to this message. After researching (https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/DNT) I managed to stumble across the ‚ÄúDNT‚Äù header which is used to indicate a user‚Äôs tracking preferences. By setting this value to ‚Äú1‚Äù it would set it so the user doesn‚Äôt want to be tracked. Adding this into the burp intruder along with the previous arguments again to attempt to bypass this message.

![Pico screenshot](/assets/images/who-8.webp)

- 5Ô∏è‚É£ After this was successful the new message below was presented.

![Pico screenshot](/assets/images/who-9.webp)

- From pre-existing knowledge I knew the ‚ÄúX-Forwarded-For‚Äù header could be employed along with a Swedish IP address.
- Taking an IP address from { https://lite.ip2location.com/sweden-ip-address-ranges?lang=en_US } I was able to pass this with the other headers.

![Pico screenshot](/assets/images/who-10.webp)

- 6Ô∏è‚É£ A new message (the final message) was returned after sending the request which implied the ‚ÄúAccept-Language‚Äù header was required

![Pico screenshot](/assets/images/who-11.webp)

- I used the header name and country to find the relevant parameter ‚Äúse-SV‚Äù and passed this final header along with all the rest to receive the output

![Pico screenshot](/assets/images/who-12.webp)

![Pico screenshot](/assets/images/who-13.webp)

# Final flag

- üö© **picoCTF{http_h34d3rs_v3ry_c0Ol_much_w0w_0c0db339}**
